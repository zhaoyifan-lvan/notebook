# QQ  

## 首包特征（该数据命中，再检测登录行为）
## desc:
	触发条件：登录QQ
	
	APPID：1
	
	解析方式：协议解析

## 包特征

	方向：C2S  
	协议：TCP

## 安卓

|4|4|4|1|4|4|
| :-: | :-: | :-: | :-: | :-: | :-: |
|包长度位|固定字节|固定字节|未知数据1长度位(固定)|未知数据1内容(不包含长度位1字节)|固定字节|
|00 00 00 15|01 33 52 39|00 00 00 00|04|4d 53 46 05|00 00 00 00|

## 苹果

|4|4|4|1|5|4|
| :-: | :-: | :-: | :-: | :-: | :-: |
|包长度位|固定字节|固定字节|未知数据1长度位(固定)|未知数据1内容(不包含长度位1字节)|固定字节|
|00 00 00 16|01 33 52 39|00 00 00 00|05|****|00 00 00 00|

## 数据样例：
### 安卓：

	00000000  00 00 00 15 01 33 52 39  00 00 00 00 04 4d 53 46   .....3R9 .....MSF
	00000010  05 00 00 00 00                                     .....

### 苹果：

	00000000  00 00 00 16 01 33 52 39  00 00 00 00 05 47 57 76   .....3R9 .....GWv
	00000010  34 05 00 00 00 00                                  4.....

## login 登录 (需先命中首包特征)
## desc:
	触发条件：登录QQ
	
	APPID：1
	
	ACTID：1211
	
	行为中文名称：登录
	
	解析方式：协议解析

## 包特征

	方向：C2S  
	协议：TCP

## 安卓

| 4 | 4 | 1 | 4 | ** | 1 | **** |
| :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: |
|包长|登录流标识|疑似序号|未知数据1长度位|未知数据1内容(不包含长度位4字节)|QQ号码长度位|<font color='red'>QQ号码(不包含长度位1字节)</font>|未知|
|****|0000000a|01/02|****|****|09-0f|****|
  ![img](/image/qq-login.png)

## 苹果

| 4 | 4 | 1 | 4 | ** | 1 |  **** |
| :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: |
|包长|登录流标识|疑似序号|未知数据1长度位|未知数据1内容(不包含长度位4字节)|QQ号码长度位|<font color='red'>QQ号码(不包含长度位1字节)</font>|未知|
|****|0000000c|01/02|****|****|09-0f|****|

## 说明
  		登录流标识：droid----0000000a

        	       ios----0000000c

## 数据样例：
### 安卓：

	00000015  00 00 02 83 00 00 00 0a  01 00 00 00 44 9b c9 9d   ........ ....D...
	00000025  17 c7 4e 97 02 6a 71 c8  e3 61 78 23 49 04 76 f8   ..N..jq. .ax#I.v.
	00000035  4a b0 4c 4b 36 b9 41 b4  88 2c 15 64 cf 20 36 d8   J.LK6.A. .,.d. 6.
	00000045  d9 9f 8a 15 dd 57 73 d6  64 f6 a3 36 79 94 21 f6   .....Ws. d..6y.!.
	00000055  0c 04 3a b1 7f 85 f1 97  5a a1 30 a9 b3 00 00 00   ..:..... Z.0.....
	00000065  00 0d 33 34 37 34 33 31  36 35 34 fe 30 ab dc b8   ..347431 654.0...
	00000075  68 e0 88 ee 07 a8 1e b8  be ce c9 87 cb f0 84 92   h....... ........
	00000085  89 1f 14 1c 88 37 28 a8  c1 c4 31 b3 2a 2f bd 11   .....7(. ..1.*/..
	00000095  10 85 31 d5 66 52 c1 fa  33 81 de 65 e2 f6 1e 8c   ..1.fR.. 3..e....
	000000A5  be dd e2 76 d1 b7 e7 fa  49 57 26 cb 83 cf 63 5d   ...v.... IW&...c]
	000000B5  43 fa 64 8e a5 05 54 fd  f4 a6 2b 34 95 c2 71 c0   C.d...T. ..+4..q.
	000000C5  44 c1 04 9d fc 5c d0 c8  d3 93 22 68 e8 35 c1 e5   D....\.. .."h.5..
	000000D5  f0 56 d2 db e4 f1 dc 10  74 9e 66 b6 8c cd d7 e0   .V...... t.f.....
	000000E5  20 cd 57 39 c3 5d 92 8f  a8 bf d9 52 56 d7 ab d9    .W9.].. ...RV...
	000000F5  ab cf 83 a7 0e 24 82 af  bf c3 e7 a1 3b 56 ab f4   .....$.. ....;V..
	00000105  53 5a a4 45 17 5f a5 45  50 87 51 6f 0f 92 55 76   SZ.E._.E P.Qo..Uv
	00000115  b8 b9 fd c4 a7 1b 83 55  49 73 a4 7d 89 3d ea 35   .......U Is.}.=.5
	00000125  86 c4 0a 93 25 64 9f 48  92 a4 88 2a 88 b3 23 fb   ....%d.H ...*..#.
	00000135  b5 36 ff f5 54 c1 a6 ac  db e1 a8 08 0d 81 24 5e   .6..T... ......$^
	00000145  ad e8 9f fa 3b de 31 92  74 83 49 af f0 cf 9c 88   ....;.1. t.I.....
	00000155  d2 ee 0c 9d 3a df 92 63  b9 58 d2 4a c5 8f 47 c1   ....:..c .X.J..G.
	00000165  20 85 9e 42 b9 66 4d 87  3a a4 c0 a5 c7 f4 83 85    ..B.fM. :.......
	00000175  34 61 54 95 36 89 e4 67  a0 c9 d3 ee c7 e3 55 64   4aT.6..g ......Ud
	00000185  da d4 33 43 56 f3 77 97  32 25 15 b1 ca 3b 59 2b   ..3CV.w. 2%...;Y+
	00000195  f9 28 8e 41 41 2b 76 69  41 3d 68 1c 59 d2 4c 34   .(.AA+vi A=h.Y.L4
	000001A5  ec 80 35 1d 12 53 ef f5  06 5d d5 f6 d8 5e 6b 7d   ..5..S.. .]...^k}
	000001B5  c9 66 9b af 37 c9 dc 96  88 79 97 d2 44 81 9a b6   .f..7... .y..D...
	000001C5  b3 7e 15 cc 96 af 30 85  c2 9f 84 a2 10 7a 4e 32   .~....0. .....zN2
	000001D5  08 61 06 07 26 19 a6 2c  44 e9 42 d2 be f1 c1 0a   .a..&.., D.B.....
	000001E5  62 ea e6 95 c1 43 54 15  a0 f1 c5 64 85 4f d0 65   b....CT. ...d.O.e
	000001F5  fe f4 ff b6 21 af a9 0f  7a 13 a8 3c 6d e7 2c 3f   ....!... z..<m.,?
	00000205  19 6b 61 c2 91 7b 10 a2  31 44 c3 34 65 ea 09 0a   .ka..{.. 1D.4e...
	00000215  16 2c 81 02 20 c5 9b 3d  a0 4e 6a 04 d3 6b 45 56   .,.. ..= .Nj..kEV
	00000225  e0 be 53 f5 53 fd 37 ab  11 42 61 f6 5f 82 6f 5e   ..S.S.7. .Ba._.o^
	00000235  83 64 82 e4 fa f0 f7 e5  3c a0 cf f4 66 ea 47 95   .d...... <...f.G.
	00000245  8f f8 4c d3 5f be 80 f5  5b b0 9b 11 75 da ed 83   ..L._... [...u...
	00000255  3c 23 09 2e c1 d9 51 68  00 49 a3 da 3a 2b c3 d6   <#....Qh .I..:+..
	00000265  a3 ca 25 a8 2a 5d e9 de  34 1a fa 33 7f 64 66 bb   ..%.*].. 4..3.df.
	00000275  ee 45 5e e8 12 98 03 df  38 a0 bd b2 48 23 2b 90   .E^..... 8...H#+.
	00000285  10 99 3c 5c 5b b6 37 08  bc 78 56 63 6b d3 8b a3   ..<\[.7. .xVck...
	00000295  dc 0f 99                                           ...

### 苹果：

	0000020E  00 00 02 34 00 00 00 0c  01 00 00 00 44 2f e5 95   ...4.... ....D/..
	0000021E  0d 9e 6e 2c 8a d2 dc 41  69 f0 2c b6 50 ae 84 69   ..n,...A i.,.P..i
	0000022E  25 a5 9d 33 d1 27 4e 60  28 f8 e7 23 36 16 de 8e   %..3.'N` (..#6...
	0000023E  aa 66 de 7b cd 51 3e 2a  98 a5 6f e3 60 16 e7 f3   .f.{.Q>* ..o.`...
	0000024E  fc 6b 5d 35 0c 38 79 3f  8d 3a 07 d5 6f 00 00 00   .k]5.8y? .:..o...
	0000025E  00 0e 32 39 32 31 33 39  31 32 38 30 3a 03 7e ed   ..292139 1280:.~.
	0000026E  9c 07 cc b0 f4 7d da a9  22 6c ba 92 b2 50 4f ff   .....}.. "l...PO.
	0000027E  86 13 66 d6 f9 e2 b5 88  a6 3b 6e 58 64 e3 26 37   ..f..... .;nXd.&7
	0000028E  62 98 6f 69 a8 09 31 43  b1 b4 74 2d 1b 43 0d 8f   b.oi..1C ..t-.C..
	0000029E  3a 63 7c fa f2 da 7b ff  26 48 d3 09 3e b2 93 83   :c|...{. &H..>...
	000002AE  2f fc 29 7b ff 28 dc 83  93 ae b8 ee 69 e7 55 6f   /.){.(.. ....i.Uo
	000002BE  25 9b 2f 6c 71 de 1b 74  b8 21 3f 0f b6 06 27 ea   %./lq..t .!?...'.
	000002CE  0c 24 38 af 87 26 df 37  cf c2 aa 4c c9 92 7a dc   .$8..&.7 ...L..z.
	000002DE  59 1d e6 3d bf a8 82 82  f5 1a 3f 85 02 ef 69 d6   Y..=.... ..?...i.
	000002EE  e7 0f 64 d8 12 9a 1c f3  dc 49 84 5c f9 a4 41 4d   ..d..... .I.\..AM
	000002FE  f6 ee 60 95 68 62 9b 9c  f3 31 9e 6f 5f 62 5f 69   ..`.hb.. .1.o_b_i
	0000030E  14 18 40 a9 be af 3a 60  41 5d 97 fc 6d 0b 3d e1   ..@...:` A]..m.=.
	0000031E  44 49 89 77 ca d6 ae 91  c3 05 5f 88 33 4b 0c 89   DI.w.... .._.3K..
	0000032E  59 fe c1 5b 50 48 b5 1d  8b 58 c5 9a 29 ac 42 a7   Y..[PH.. .X..).B.
	0000033E  e5 ca 83 e4 a5 c3 80 24  60 a9 84 4c 71 36 d9 2e   .......$ `..Lq6..
	0000034E  81 f3 c8 67 c7 8f 4b 16  fd 54 92 8b 91 2f d3 7f   ...g..K. .T.../..
	0000035E  0b fa 36 52 de 01 95 89  a1 2c 25 17 d9 70 ed c9   ..6R.... .,%..p..
	0000036E  74 53 1a 65 0e b9 7e 0f  a0 01 94 9c e0 4c 33 43   tS.e..~. .....L3C
	0000037E  af 64 43 7b e6 6f e6 2a  1f 31 fa ec d9 68 d1 39   .dC{.o.* .1...h.9
	0000038E  d3 b5 6e 37 8e 47 eb ba  bf e4 29 f9 6e e4 b2 a4   ..n7.G.. ..).n...
	0000039E  85 06 e3 6a 8e 0f 9b 35  bc 22 7c 9c 31 ad 7e 14   ...j...5 ."|.1.~.
	000003AE  5c 31 f8 0e 98 c7 dc f0  fb 52 8e be df fb d5 a9   \1...... .R......
	000003BE  b5 35 40 fe 83 58 9a 0d  df f1 80 90 0f ee ff ff   .5@..X.. ........
	000003CE  c9 7f 3c cf f8 07 2c c4  ac a8 dd 7e 43 c2 04 e3   ..<...,. ...~C...
	000003DE  d8 70 39 44 05 d6 27 af  60 7e 65 03 c4 b6 75 ed   .p9D..'. `~e...u.
	000003EE  fa c6 c6 bf d9 58 db cc  08 80 b9 8d 60 3e cd 9b   .....X.. ....`>..
	000003FE  83 3d e5 fa 3d 8d f2 80  b3 94 79 e2 2e 7f a0 79   .=..=... ..y....y
	0000040E  e9 b6 31 a4 68 ca 1d 71  28 6a d3 0a 87 e2 1b 10   ..1.h..q (j......
	0000041E  90 1a 3d f2 fd 13 5f 22  00 0a ba 0c 41 27 8c a3   ..=..._" ....A'..
	0000042E  43 a9 0b 2d 46 ce 58 7e  15 93 85 f0 41 de 72 b1   C..-F.X~ ....A.r.
	0000043E  2d e8 2a 41                                        -.*A

## message 消息流
| 2 | 2 | 4 | 1 | 4 | - | - | 1 | QQ号 | **** |
| :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: |
|未知|包长|消息流标识|疑似序号|未知|-|-|QQ长度|QQ号|未知|
|0000|0067/6f|0000000b/0d|01|00000000|-|-|0a-0f|738502429|****|
  ![img](/image/qq-message.png)
  
  消息流标识：droid----0000000b

              ios----0000000d

  发消息：droid----0067(64-6a)应答

          ios----006f(6c-71)应答

  收消息：both----014f(4c-51)应答

  ##发语音消息：both----0147(44-4a)应答(误报群发消息表情)

  收语音消息：droid----00e3(e0-e6)请求

              ios----0103(00-06)请求--会同时报普通收消息



## send-file 发文件流---包长 = 9 + 0x3a + 0x00 + 1
| 1 | 4 | 4 | 1 | 1 | 3 | 1 | QQ号 | 1 | 1 |10| 1 | 1 |****|
| :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: |
|传文件标识|长度|4位数据长度|0a|未知|3位固定|1位QQ长度|QQ号|未知|长度|文件传输标识PicUp.Echo|空格|数据序号|后续|
|28|00 00 .. ..|0000长度|0a|**|080112|Q长度|738502429|1a|0a/c|PicUp.Echo(首包,后为DataUp)| 20 |序号|后续**|
  ![img](/image/qq-file.png)
  
  PicUp
  文件流标识：droid----002b/002c

              ios----003a/3b
  ![img](/image/qq-image.png)
  
  图片分两条流，每条流有若干段，
  
  同一图片标识：一串数
  
  段的序号顺序标识：PicUp.DataUp之后 01/02/03/，1，3，5段在第一条流里，2，4，6，段在第二条流
  
  （7,8位20 00表示每段长度）除了最后一段都是8192字节，最后一段图片格式的IEND结尾标识，
  
  每段私有协议固定格式，长字符串结尾处偏移44位后为  原始数据
  
  PNG:89504E47****
  
  jpg:FFD8**
  
  JFIF:FFD8FFE0****

  语音消息: 616d72 对应明文（amr）
  


## voip 语音视频udp
| 1 | 2 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | 4 | **** |结尾|
| :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: |
|标识|包长|标识|未知|未知|账号前缀|己端账号|未知|账号前缀|对端账号|未知|结尾|
|02|0048|00010000|********|********|00000000|16进制账号|********|00000000|16进制账号|****|03|
  ![img](/image/qq-voip.png)

    udp流2:请求方向,包长 = 9 + 0x73 + 0x0308 + 1
    
  28 00 00 00 74/73 00 00 03   08                80
         10               02 18 00 20
    
  第8个字节ASCII码值不超过03，第10个字节为08，第12个字节是80，第20个字节是10，第26、27、28个字节是18、00、20

## 发送_大文件
### 数据样例：
	POST /?ver=2&ukey=C242B119645BE31D0F124FC3217CB6848D5B528F909C481AE862C8BA65B2F3B9B08E60318241F4D6B7662F6B092201448BA5C6AD7E4132BC03932083693460DC2F64613033626430302D313165342D343432362D383738352D3064613830383031626562343F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F&filekey=718de5417e57198c30cf38d812a2810c06ba9ca8&filesize=112893096&bmd5=3DF71C0896FDE3221F701074FA588E2E&range=0&mType=Other HTTP/1.1
	Net-type: wifi
	cache-control: no-cache
	Range: bytes=0-
	Content-Length: 32768
	Content-Type: application/x-www-form-urlencoded
	User-Agent: Dalvik/2.1.0 (Linux; U; Android 10; JEF-AN20 Build/HUAWEIJEF-AN20)
	Host: 218.68.89.18
	Connection: Keep-Alive
	Accept-Encoding: gzip

	....ftypmp42....isommp42..H.moov...lmvhd......a*..a*.......4................................................@..................................&udta.....xyz....+40.0449+116.2816/...&gnre......TypeNormalVideo............vmeta...!hdlr........mdta................+keys............mdtacom.android.version..."ilst............data........10...ptrak...\tkhd......a*..a*...........4................................................@........8......mdia...
### 匹配规则：
        "pattern": {
                 "method": "POST",
                 "uri": "^/\\?ver=\\d&ukey=\\S+&filekey=\\w+&filesize=\\d+&bmd5=\\w+&mType="
              }